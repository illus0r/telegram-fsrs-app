# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. **–†–µ–≤–∏–∑–∏–∏ –Ω–µ —É–≤–µ–ª–∏—á–∏–≤–∞–ª–∏—Å—å –ø—Ä–∏ –æ—Ç–≤–µ—Ç–∞—Ö –Ω–∞ –∫–∞—Ä—Ç—ã**

**–ü—Ä–æ–±–ª–µ–º–∞**: –í `App.tsx` —Ñ—É–Ω–∫—Ü–∏—è `handleSaveProgress()` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ `saveDataLocally(tsvData, false)`, —á—Ç–æ –Ω–µ —É–≤–µ–ª–∏—á–∏–≤–∞–ª–æ –ª–æ–∫–∞–ª—å–Ω—É—é —Ä–µ–≤–∏–∑–∏—é.

**–†–µ—à–µ–Ω–∏–µ**: –ò–∑–º–µ–Ω–µ–Ω–æ –Ω–∞ `saveDataLocally(tsvData, true)` - —Ç–µ–ø–µ—Ä—å –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç —Ä–µ–≤–∏–∑–∏—é.

```typescript
// –ë—ã–ª–æ:
await saveDataLocally(tsvData, false); // Don't increment revision for auto-save

// –°—Ç–∞–ª–æ:
await saveDataLocally(tsvData, true); // Always increment revision for progress save
```

### 2. **–û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤ –æ–±–ª–∞–∫–æ**

**–ü—Ä–æ–±–ª–µ–º–∞**: –ü–æ—Å–∫–æ–ª—å–∫—É —Ä–µ–≤–∏–∑–∏—è –Ω–µ —É–≤–µ–ª–∏—á–∏–≤–∞–ª–∞—Å—å, `syncStatus.needsCloudWrite()` –≤–æ–∑–≤—Ä–∞—â–∞–ª `false`, –∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∏—Å—å –≤ –æ–±–ª–∞–∫–æ.

**–†–µ—à–µ–Ω–∏–µ**: –¢–µ–ø–µ—Ä—å –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏:
1. –†–µ–≤–∏–∑–∏—è —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è
2. `needsCloudWrite()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `true`
3. –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ñ–æ–Ω–æ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

## ‚ú® –î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### 1. **–ü—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö –∏–∑ –æ–±–ª–∞–∫–∞**

–î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å, —á—Ç–æ –∏–º–µ–Ω–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ Telegram CloudStorage:

- –ö–Ω–æ–ø–∫–∞ "üîç –ü–æ–∫–∞–∑–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –æ–±–ª–∞–∫–∞"
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö (–≤–µ—Ä—Å–∏—è, —Ä–µ–≤–∏–∑–∏—è, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞—Ç—á–µ–π)
- –ü–æ–∫–∞–∑ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –≤—Å–µ—Ö –±–∞—Ç—á–µ–π
- –ü–æ–ª–Ω—ã–µ TSV –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

### 2. **–î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**

–î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:

**–í App.tsx**:
- –õ–æ–≥–∏ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
- –£–∫–∞–∑–∞–Ω–∏–µ —Ç–∏–ø–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–æ—Ç–≤–µ—Ç –Ω–∞ –∫–∞—Ä—Ç—É, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ)

**–í storage.ts**:
- –î–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–≤–∏–∑–∏–π –ø—Ä–∏ –∑–∞–ø–∏—Å–∏ –≤ –æ–±–ª–∞–∫–æ
- –°—Ç–∞—Ç—É—Å –æ–ø–µ—Ä–∞—Ü–∏–π –∑–∞–ø–∏—Å–∏/—á—Ç–µ–Ω–∏—è

**–í syncStatus.ts**:
- –ò–∑–º–µ–Ω–µ–Ω–∏—è —Ä–µ–≤–∏–∑–∏–π —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —Å—Ç–∞—Ä–æ–≥–æ –∏ –Ω–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
- –°—Ç–∞—Ç—É—Å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø–µ—Ä–∞—Ü–∏–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

### 3. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**

–í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏:

```typescript
// –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –æ–±–ª–∞–∫–∞
getCloudMetadata(): Promise<CloudMetadata | null>

// –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Å–ø–µ–∫—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –æ–±–ª–∞–∫–∞
inspectCloudData(): Promise<{...}>

// –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
downloadAndShowCloudData(): Promise<string>
```

## üîç –ö–∞–∫ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞

### –ü—Ä–∏ –ª—é–±–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö:
1. **–ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ** - –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ localStorage
2. **–£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–µ–≤–∏–∑–∏–∏** - `revision_local++`
3. **–ó–∞–ø—É—Å–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏** - —Ñ–æ–Ω–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ CloudStorage
4. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

### –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:
- –ö–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è `needsCloudWrite()`
- –ï—Å–ª–∏ `revision_local > revision_server` - –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å—å
- –ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–ø–∏—Å–∏ —Ä–µ–≤–∏–∑–∏–∏ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞—é—Ç—Å—è

### –û—Ç–ª–∞–¥–∫–∞:
- –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ä–µ–≤–∏–∑–∏—è–º–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
- –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å —Ç–æ—á–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –æ–±–ª–∞–∫–µ

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ–≥–ª–∞—Å–Ω–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º:
- ‚úÖ –†–µ–≤–∏–∑–∏–∏ —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏
- ‚úÖ –î–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è —Å –æ–±–ª–∞–∫–æ–º
- ‚úÖ –ï—Å—Ç—å –ø–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- ‚úÖ –ú–æ–∂–Ω–æ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ–±–ª–∞–∫–∞
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

## üîß –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã:
1. –û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–∞—Ä—Ç - —Ä–µ–≤–∏–∑–∏—è –¥–æ–ª–∂–Ω–∞ —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å—Å—è
2. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ - –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ä–µ–≤–∏–∑–∏—è—Ö
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ "–ü–æ–∫–∞–∑–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –æ–±–ª–∞–∫–∞" –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞